name: Notify Discord
on:
  push:
    branches: [ main ]
  pull_request:

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: 깃헙알리미미쿠쨩
        env:
          DISCORD_WEBHOOK: ${{ secrets.MIKU_WEBHOOK }}
        run: |
          jq -n --arg content ":rocket: $GITHUB_REPOSITORY @ $GITHUB_REF" \
                --arg username "playteddypicker" \
                --arg avatar_url "https://avatars.githubusercontent.com/playteddypicker" \
                '{content:$content, username:$username, avatar_url:$avatar_url}' \
          | curl -sS -H "Content-Type: application/json" -d @- "$DISCORD_WEBHOOK"

